<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>AR収納ラベル（Hiro）</title>
  <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <style>body{margin:0;overflow:hidden}</style>
</head>
<body>
  <a-scene embedded arjs vr-mode-ui="enabled:false" renderer="antialias:true; logarithmicDepthBuffer:true">
    <!-- 画像・Canvasなどのアセット置き場 -->
    <a-assets>
      <!-- ラベル用のCanvas（ここに日本語を描く） -->
      <canvas id="labelCanvas" width="1024" height="512"></canvas>
    </a-assets>

    <a-marker preset="hiro">
      <!-- 台座（ユーザーのベースを尊重） -->
      <!-- <a-box position="0 0.5 0" width="1" height="0.1" depth="1" color="#3f51b5"></a-box> -->

      <!-- 日本語ラベル面（Canvasをテクスチャとして貼る） -->
      <!-- ※ マーカー面と平行に寝かせる -->
      <a-plane position="0 0.7 0" rotation="-90 0 0"
               width="1.6" height="0.8"
               material="src: #labelCanvas; side:double; transparent:false">
      </a-plane>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    // ====== ここを書き換えるだけでラベル内容を変更できます ======
    const title = "引き出し 収納ラベル";
    const lines = [
      "上段：文房具（ペン・ハサミ・付箋）",
      "中段：ケーブル（USB-C・HDMI・延長）",
      "下段：書類A（学校・保険・領収書）"
    ];
    // ============================================================

    function drawLabel() {
      const canvas = document.getElementById('labelCanvas');
      const ctx = canvas.getContext('2d');

      // 背景（白）
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // 枠線
      ctx.strokeStyle = '#333333';
      ctx.lineWidth = 8;
      ctx.strokeRect(16, 16, canvas.width-32, canvas.height-32);

      // タイトル
      ctx.fillStyle = '#111111';
      ctx.font = 'bold 64px sans-serif';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'top';
      ctx.fillText(title, canvas.width/2, 40);

      // リスト本文
      ctx.font = '48px sans-serif';
      ctx.textAlign = 'left';
      const startX = 80;
      let y = 150;
      const lineGap = 70;

      lines.forEach(text => {
        ctx.fillText(text, startX, y);
        y += lineGap;
      });

      // A-Frame にテクスチャ更新を伝える（保険）
      const planeEl = document.querySelector('a-plane');
      planeEl.addEventListener('materialtextureloaded', () => {
        const mesh = planeEl.getObject3D('mesh');
        if (mesh && mesh.material && mesh.material.map) {
          mesh.material.map.needsUpdate = true;
        }
      });
      // 既にロード済みでも更新
      const mesh = planeEl.getObject3D('mesh');
      if (mesh && mesh.material && mesh.material.map) {
        mesh.material.map.needsUpdate = true;
      }
    }

    // ページ読み込み後に描画
    window.addEventListener('load', drawLabel);
  </script>
</body>
</html>
