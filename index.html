<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>AR収納ラベル（キッチン上の戸棚）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <style>body{margin:0;overflow:hidden}</style>
</head>
<body>
  <a-scene embedded vr-mode-ui="enabled:false" renderer="antialias:true; logarithmicDepthBuffer:true" arjs="sourceType: webcam; debugUIEnabled:false">
    <a-assets>
      <canvas id="labelCanvas" width="1280" height="800"></canvas>
    </a-assets>

    <a-marker preset="hiro">
      <a-box position="0 0.5 0" width="1" height="0.1" depth="1" color="#3f51b5"></a-box>
      <a-plane position="0 0.7 0" rotation="-90 0 0" width="1.8" height="1.0" material="src: #labelCanvas; side:double; transparent:false"></a-plane>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    const title = "キッチン上の戸棚";
    const items = ["食器用洗剤","スポンジ","ジップロック","キッチン泡ハイター","ブンブンチョッパー","土鍋"];

    function drawLabel(){
      const cvs = document.getElementById('labelCanvas');
      const ctx = cvs.getContext('2d');

      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0,0,cvs.width,cvs.height);
      ctx.strokeStyle = '#222';
      ctx.lineWidth = 10;
      ctx.strokeRect(20,20,cvs.width-40,cvs.height-40);

      ctx.fillStyle = '#111';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'top';
      ctx.font = 'bold 72px system-ui, -apple-system, Segoe UI, Roboto, Noto Sans JP, sans-serif';
      ctx.fillText(title, cvs.width/2, 40);

      ctx.strokeStyle = '#ddd';
      ctx.lineWidth = 4;
      ctx.beginPath();
      ctx.moveTo(60, 130);
      ctx.lineTo(cvs.width-60, 130);
      ctx.stroke();

      ctx.textAlign = 'left';
      ctx.font = '56px system-ui, -apple-system, Segoe UI, Roboto, Noto Sans JP, sans-serif';
      const startX = 120;
      let y = 180;
      const gap = 85;

      items.forEach(t => {
        ctx.fillStyle = '#444';
        ctx.beginPath();
        ctx.arc(startX-40, y+24, 10, 0, Math.PI*2);
        ctx.fill();
        ctx.fillStyle = '#111';
        ctx.fillText(t, startX, y);
        y += gap;
      });

      const plane = document.querySelector('a-plane');
      const mesh = plane.getObject3D('mesh');
      if (mesh && mesh.material && mesh.material.map) {
        mesh.material.map.needsUpdate = true;
      } else {
        plane.addEventListener('materialtextureloaded', () => {
          const m = plane.getObject3D('mesh');
          if (m && m.material && m.material.map) m.material.map.needsUpdate = true;
        });
      }
    }

    window.addEventListener('load', drawLabel);
  </script>
</body>
</html>
